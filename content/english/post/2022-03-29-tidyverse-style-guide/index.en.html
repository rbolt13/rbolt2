---
title: Tidyverse Style Guide (Part 1)
author: Randi Bolt
date: '2022-03-29'
slug: []
categories: 
  - undergrad
tags: []
output:
  blogdown::html_page:
    toc: TRUE
---


<div id="TOC">
<ul>
<li><a href="#analyses">Analyses</a>
<ul>
<li><a href="#files">1. Files</a></li>
<li><a href="#syntax">2. Syntax</a>
<ul>
<li><a href="#object-names">Object names</a></li>
<li><a href="#spacing">Spacing</a></li>
<li><a href="#function-calls">Function Calls</a></li>
<li><a href="#control-flow">Control flow</a></li>
<li><a href="#long-lines">Long lines</a></li>
<li><a href="#semicolons">Semicolons</a></li>
<li><a href="#assignment">Assignment</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#comments">Comments</a></li>
</ul></li>
<li><a href="#functions">3. Functions</a>
<ul>
<li><a href="#naming">Naming</a></li>
<li><a href="#long-lines-1">Long lines</a></li>
<li><a href="#return">return()</a></li>
<li><a href="#comments-1">Comments</a></li>
</ul></li>
<li><a href="#pipes">4. Pipes</a>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#whitespace">Whitespace</a></li>
<li><a href="#long-lines-2">Long lines</a></li>
<li><a href="#short-pipes">Short pipes</a></li>
<li><a href="#no-arguments">No arguments</a></li>
<li><a href="#assigment">Assigment</a></li>
</ul></li>
<li><a href="#ggplot2">5. ggplot2</a>
<ul>
<li><a href="#introduction-1">Introduction</a></li>
<li><a href="#whitespace-1">Whitespace</a></li>
<li><a href="#long-lines-3">Long lines</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<p>This is part 1 of my notes from <a href="https://style.tidyverse.org/">the tidyverse style guide</a>.</p>
<div id="analyses" class="section level1">
<h1>Analyses</h1>
<div id="files" class="section level2">
<h2>1. Files</h2>
<ul>
<li><p>names are meaningful and use letters, numbers, <code>_</code>, and/or <code>-</code>.</p></li>
<li><p>avoid special characters in files names.</p></li>
<li><p>if more than 10 files then left pad with a zero (i.e. 00, 01, 02, 03,…)</p></li>
<li><p>rename files instead of attempting 02a, 02b, and so on.</p></li>
<li><p>pay attention to capitalization.</p></li>
<li><p>use <code>-</code> and <code>=</code> to break up file into readable chunks.</p></li>
<li><p>load all packages at once in the beginning of the file.</p></li>
</ul>
<pre class="r"><code># Load data ---------------------------

# Plot data ---------------------------</code></pre>
</div>
<div id="syntax" class="section level2">
<h2>2. Syntax</h2>
<div id="object-names" class="section level3">
<h3>Object names</h3>
<ul>
<li><p>Variables and function names should use lovercase letters, numbers and <code>_</code> (no camel case).</p></li>
<li><p>Base R uses dots in function and class names (<code>data.frame</code>).</p></li>
<li><p>Variable names should be names and nouns.</p></li>
<li><p>Function names should be verbs.</p></li>
<li><p>Names should be concise and meaningful.</p></li>
<li><p>Avoid re-using names of common function and variables.</p></li>
</ul>
</div>
<div id="spacing" class="section level3">
<h3>Spacing</h3>
<ul>
<li><p>Put a space after a common, never before.</p></li>
<li><p>Do not put spaces inside or outside parentheses for regular functions : <code>mean(x, na.rm = TRUE)</code>.</p></li>
<li><p>Put a space before and after () when using if, for, or while.</p></li>
</ul>
<pre class="r"><code># if (debug) {
#   show(x)
# }</code></pre>
<ul>
<li><p>Place a space after <code>()</code> used for function arguments : <code>function(x) {}</code>.</p></li>
<li><p>The embracing operator, <code>{{ }}</code>, should always have inner spaces to help emphasize its special behavior.</p></li>
<li><p>Most infix operators (<code>==</code>, <code>+</code>, <code>-</code>, <code>&lt;-</code>, etc.) should always be surrounded by spaces.</p></li>
<li><p>Exceptions being:</p>
<ul>
<li><p>The operators with high precedence: <code>::</code>, <code>:::</code>, <code>$</code>, <code>@</code>, <code>[</code>, <code>[[</code>, <code>^</code>, <code>unary -</code>, <code>unary +</code>, and <code>:</code>.</p></li>
<li><p>Single-sided formulas when the right-hand side is a single identifier: <code>call(!!xyz)</code>.</p></li>
<li><p>When used in tidy evaluation <code>!!</code> (bang-bang) and <code>!!!</code> (bang-bang-bang) (because have precedence equivalent to unary <code>-/+</code>).</p></li>
<li><p>The helper operator: <code>package?stats</code>.</p></li>
</ul></li>
<li><p>adding extra spaces is ok if it improves alignment of <code>=</code> or <code>&lt;-</code>.</p></li>
</ul>
</div>
<div id="function-calls" class="section level3">
<h3>Function Calls</h3>
<ul>
<li><p>When you call a function omit the names of data arguemnts (such as <code>x=</code> because it is used so commonly).</p></li>
<li><p>If you override the default value of an argument, use the full name.</p></li>
<li><p>Avoid assignments in function calls.</p>
<ul>
<li>Exception: function that capture side-effects: <code>output &lt;- capture.output(x &lt;- f())</code>.</li>
</ul></li>
</ul>
</div>
<div id="control-flow" class="section level3">
<h3>Control flow</h3>
<ul>
<li><p>For <code>{}</code> brackets:</p>
<ul>
<li><p><code>{</code> should be the last character on the line.</p></li>
<li><p>Contents should be indented by two spaces.</p></li>
<li><p><code>}</code> should be the first character on the line.</p></li>
<li><p>Else should be on the same line as <code>}</code> (if used).</p></li>
</ul></li>
<li><p><code>{}</code> define the most important hierarchy of R code.</p></li>
<li><p>Always use <code>&amp;&amp;</code> and <code>||</code> inside an if clause and never <code>&amp;</code> and <code>|</code>.</p></li>
<li><p>If you want to rewrite a simple but lengthy if block:</p></li>
</ul>
<pre class="r"><code>if (x &gt; 10) {
  message &lt;- &quot;big&quot;
} else {
  message &lt;- &quot;small&quot;
}</code></pre>
<p>Just write it all on one line:</p>
<pre class="r"><code>message &lt;- if (x &gt; 10) &quot;big&quot; else &quot;small&quot;</code></pre>
<ul>
<li><p>it is okay to drop curly braces for very simple statements that fit on one line as long as they dont have side-effects.</p></li>
<li><p>Function calls that affect control flow (like return(), stop() or continue) should always go in their own {} block.</p></li>
<li><p>Avoid implicit type coercion (e.g. from numeric to logical) in if statements:</p></li>
</ul>
<pre class="r"><code># Good
if (length(x) &gt; 0) {
  # do something
}</code></pre>
<pre><code>## NULL</code></pre>
<pre class="r"><code># Bad
if (length(x)) {
  # do something
}</code></pre>
<pre><code>## NULL</code></pre>
<ul>
<li><p>Avoid postion-based <code>switch()</code> statements.</p></li>
<li><p>Each element should go on its own line.</p></li>
<li><p>Provided a fall-through erro, unless you have previously validate the input.</p></li>
</ul>
<pre class="r"><code>switch(x, 
  a = 0,
  b = 1, 
  c = 2,
  stop(&quot;Unknown `x`&quot;, call. = FALSE)
)</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="long-lines" class="section level3">
<h3>Long lines</h3>
<ul>
<li>Limit code to 80 characters per line. This fits comfortably on a printed page with a reasonably sized font.</li>
</ul>
<pre class="r"><code># # Good
# do_something_very_complicated(
#   something = &quot;that&quot;,
#   requires = many,
#   arguments = &quot;some of which may be long&quot;
# )
# 
# # Bad
# do_something_very_complicated(&quot;that&quot;, requires, many, arguments,
#                               &quot;some of which may be long&quot;
#                               )</code></pre>
<ul>
<li>You may also place several arguments on the same line if they are closely related to each other, e.g., strings in calls to paste() or stop().</li>
</ul>
</div>
<div id="semicolons" class="section level3">
<h3>Semicolons</h3>
<ul>
<li>Don’t put ; at the end of a line, and don’t use ; to put multiple commands on one line.</li>
</ul>
</div>
<div id="assignment" class="section level3">
<h3>Assignment</h3>
<ul>
<li>Use &lt;-, not =, for assignment.</li>
</ul>
</div>
<div id="data" class="section level3">
<h3>Data</h3>
<ul>
<li><p>Use <code>"</code>, not <code>'</code>, for quoting text. The only exception is when the text already contains double quotes and no single quotes.</p></li>
<li><p>Prefer TRUE and FALSE over T and F.</p></li>
</ul>
</div>
<div id="comments" class="section level3">
<h3>Comments</h3>
<ul>
<li><p>Each line of a comment should begin with the comment symbol and a single space.</p></li>
<li><p>In data analysis code, use comments to record important findings and analysis decisions.</p></li>
<li><p>If you need comments to explain what your code is doing, consider rewriting your code to be clearer.</p></li>
<li><p>If you discover that you have more comments than code, consider switching to R Markdown.</p></li>
</ul>
</div>
</div>
<div id="functions" class="section level2">
<h2>3. Functions</h2>
<div id="naming" class="section level3">
<h3>Naming</h3>
<ul>
<li>Strive to use verbs for function names.</li>
</ul>
</div>
<div id="long-lines-1" class="section level3">
<h3>Long lines</h3>
<ul>
<li>Prefer function-indent style to double-indent style when it fits.</li>
</ul>
<pre class="r"><code># Function-indent --------------------------------------
long_function_name &lt;- function(a = &quot;a long argument&quot;,
                               b = &quot;another argument&quot;,
                               c = &quot;another long argument&quot;) {
  # As usual code is indented by two spaces.
}

# Double-indent ----------------------------------------
long_function_name &lt;- function(
    a = &quot;a long argument&quot;,
    b = &quot;another argument&quot;,
    c = &quot;another long argument&quot;) {
  # As usual code is indented by two spaces.
}</code></pre>
<ul>
<li>If a function argument can’t fit on a single line, this is a sign you should rework the argument to keep it short and sweet.</li>
</ul>
</div>
<div id="return" class="section level3">
<h3>return()</h3>
<ul>
<li>Only use return() for early returns. Otherwise, rely on R to return the result of the last evaluated expression.</li>
</ul>
<pre class="r"><code># Good
find_abs &lt;- function(x) {
  if (x &gt; 0) {
    return(x)
  }
  x * -1
}
add_two &lt;- function(x, y) {
  x + y
}

# Bad
add_two &lt;- function(x, y) {
  return(x + y)
}</code></pre>
<ul>
<li><p>Return statments should always be on their own line because they have important effects on the control flow.</p></li>
<li><p>If your function is called primarily for its side-effects (like printing, plotting, or saving to disk), it should return the first argument invisibly. This makes it possible to use the function as part of a pipe.</p></li>
</ul>
</div>
<div id="comments-1" class="section level3">
<h3>Comments</h3>
<ul>
<li><p>In code, use comments to explain the “why” not the “what” or “how”.</p></li>
<li><p>Comments should be in sentence case, and only end with a full stop if they contain at least two sentences.</p></li>
</ul>
<pre class="r"><code># Good

# Objects like data frames are treated as leaves

# Do not use `is.list()`. Objects like data frames must be treated
# as leaves.

# Bad

# objects like data frames are treated as leaves

# Objects like data frames are treated as leaves.</code></pre>
</div>
</div>
<div id="pipes" class="section level2">
<h2>4. Pipes</h2>
<div id="introduction" class="section level3">
<h3>Introduction</h3>
<ul>
<li><p>Reserve pipes for a sequence of steps applied to one primary object.</p></li>
<li><p>Avoid using pipes when there are meaningful intermediate objects that could be given informative names.</p></li>
</ul>
</div>
<div id="whitespace" class="section level3">
<h3>Whitespace</h3>
<ul>
<li><code>%&gt;%</code> should always have a space before it, and should usually be followed by a new line. After the first step, each line should be indented by two spaces.</li>
</ul>
</div>
<div id="long-lines-2" class="section level3">
<h3>Long lines</h3>
<ul>
<li>If the arguments to a function don’t all fit on one line, put each argument on its own line and indent.</li>
</ul>
</div>
<div id="short-pipes" class="section level3">
<h3>Short pipes</h3>
<ul>
<li><p>A one-step pipe can stay on one line, but unless you plan to expand it later on, you should consider rewriting it to a regular function call.</p></li>
<li><p>Sometimes it’s useful to include a short pipe as an argument to a function in a longer pipe. Carefully consider whether the code is more readable with a short inline pipe (which doesn’t require a lookup elsewhere) or if it’s better to move the code outside the pipe and give it an evocative name.</p></li>
</ul>
<pre class="r"><code># Good
# x %&gt;%
#   select(a, b, w) %&gt;%
#   left_join(y %&gt;% select(a, b, v), by = c(&quot;a&quot;, &quot;b&quot;))
# 
# # Better
# x_join &lt;- x %&gt;% select(a, b, w)
# y_join &lt;- y %&gt;% select(a, b, v)
# left_join(x_join, y_join, by = c(&quot;a&quot;, &quot;b&quot;))</code></pre>
</div>
<div id="no-arguments" class="section level3">
<h3>No arguments</h3>
<ul>
<li>magrittr allows you to omit () on functions that don’t have arguments. Avoid this feature.</li>
</ul>
</div>
<div id="assigment" class="section level3">
<h3>Assigment</h3>
<p>There are three acceptable forms of assignment:</p>
<ul>
<li>Variable name and assignment on separate lines:</li>
</ul>
<pre class="r"><code>iris_long &lt;-
  iris %&gt;%
  gather(measure, value, -Species) %&gt;%
  arrange(-value)</code></pre>
<ul>
<li>Variable name and assignment on the same line:</li>
</ul>
<pre class="r"><code>iris_long &lt;- iris %&gt;%
  gather(measure, value, -Species) %&gt;%
  arrange(-value)</code></pre>
<ul>
<li>Assignment at the end of the pipe with <code>-&gt;</code>:</li>
</ul>
<pre class="r"><code>iris %&gt;%
  gather(measure, value, -Species) %&gt;%
  arrange(-value) -&gt;
  iris_long</code></pre>
<ul>
<li>The magrittr package provides the <code>%&lt;&gt;%</code> operator as a shortcut for modifying an object in place. Avoid this operator.</li>
</ul>
</div>
</div>
<div id="ggplot2" class="section level2">
<h2>5. ggplot2</h2>
<div id="introduction-1" class="section level3">
<h3>Introduction</h3>
<ul>
<li>Styling suggestions for <code>+</code> used to separate ggplot2 layers are very similar to those for <code>%&gt;%</code> in pipelines.</li>
</ul>
</div>
<div id="whitespace-1" class="section level3">
<h3>Whitespace</h3>
<ul>
<li><p><code>+</code> should always have a space before it, and should be followed by a new line.</p></li>
<li><p>If you are creating a ggplot off of a dplyr pipeline, there should only be one level of indentation.</p></li>
</ul>
</div>
<div id="long-lines-3" class="section level3">
<h3>Long lines</h3>
<ul>
<li><p>If the arguments to a ggplot2 layer don’t all fit on one line, put each argument on its own line and indent.</p></li>
<li><p>ggplot2 allows you to do data manipulation, such as filtering or slicing, within the data argument. Avoid this, and instead do the data manipulation in a pipeline before starting plotting.</p></li>
</ul>
</div>
</div>
</div>
